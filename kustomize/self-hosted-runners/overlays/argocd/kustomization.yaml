apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- ../../base

nameSuffix: -argocd

patches:
  - patch: |-
      apiVersion: actions.summerwind.dev/v1alpha1
      kind: RunnerDeployment
      metadata:
        name: runner-deployment
        namespace: cicd
      spec:
        template:
          spec:
            repository: wilinger/argocd-homelab
  - patch: |-
      apiVersion: actions.summerwind.dev/v1alpha1
      kind: HorizontalRunnerAutoscaler
      metadata:
        name: autoscaler
        namespace: cicd
      spec:
        scaleTargetRef:
          name: runner-deployment-argocd
